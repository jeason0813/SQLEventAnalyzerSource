use [{0}]

if exists (select o.* from dbo.sysobjects o where o.id = object_id(N'[dbo].[GetRegEx]') and o.xtype  = N'FS')
drop function [dbo].[GetRegEx]

if exists (select o.* from dbo.sysobjects o where o.id = object_id(N'[dbo].[MatchRegEx]') and o.xtype  = N'FS')
drop function [dbo].[MatchRegEx]

if exists (select o.* from dbo.sysobjects o where o.id = object_id(N'[dbo].[GetStoredProcedureName]') and o.xtype  = N'FS')
drop function [dbo].[GetStoredProcedureName]

if exists (select o.* from dbo.sysobjects o where o.id = object_id(N'[dbo].[MatchStoredProcedureName]') and o.xtype  = N'FS')
drop function [dbo].[MatchStoredProcedureName]

if exists (select o.* from dbo.sysobjects o where o.id = object_id(N'[dbo].[GetStoredProcedureParameter]') and o.xtype  = N'FS')
drop function [dbo].[GetStoredProcedureParameter]

if exists (select o.* from dbo.sysobjects o where o.id = object_id(N'[dbo].[MatchStoredProcedureParameter]') and o.xtype  = N'FS')
drop function [dbo].[MatchStoredProcedureParameter]

if exists (select o.* from dbo.sysobjects o where o.id = object_id(N'[dbo].[GetLogParameter]') and o.xtype  = N'FS')
drop function [dbo].[GetLogParameter]

if exists (select o.* from dbo.sysobjects o where o.id = object_id(N'[dbo].[MatchLogParameter]') and o.xtype  = N'FS')
drop function [dbo].[MatchLogParameter]

if exists (select a.* from sys.assemblies a where a.name = 'SQLEventAnalyzerCLR')
drop assembly [SQLEventAnalyzerCLR]

create assembly [SQLEventAnalyzerCLR]
authorization [dbo]
from 0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C0103005FE2B4540000000000000000E00002210B010B00001800000006000000000000DE370000002000000040000000000010002000000002000004000000000000000400000000000000008000000002000000000000030040850000100000100000000010000010000000000000100000000000000000000000903700004B000000004000000004000000000000000000000000000000000000006000000C000000583600001C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000E4170000002000000018000000020000000000000000000000000000200000602E72737263000000000400000040000000040000001A0000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000001E00000000000000000000000000004000004200000000000000000000000000000000C037000000000000480000000200050034290000240D00000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000133002002F0000000100001103730F00000A0A06026F1000000A0B076F1100000A2C12076F1200000A176F1300000A6F1400000A2A72010000702A0013300200280000000100001102281500000A2D0803281500000A2C02162A03730F00000A0A06026F1000000A0B076F1100000A2A133002003300000002000011150A160B170C2B0E0207280D0000060A060B0817580C080331EE0615330672010000702A0602280C0000060D097B010000042A00133002003A00000002000011150A160B170C2B0E0207280D0000060A060B0817580C080431EE06153302162A0602280C0000060D097B0100000403281600000A2C02172A162A0000133003005F00000003000011020428090000060A062C4E02067B020000046F1700000A6F1800000A0B07280A0000060C03163121160D2B1209031759330808096F1900000A2A0917580D09086F1A00000A32E52B10086F1A00000A13041204281B00000A2A72010000702A00133003006D00000003000011020528090000060A062C6002067B020000046F1700000A6F1800000A0B07280A0000060C0316312A160D2B1B09031759331108096F1900000A04281600000A2C02172A0917580D09086F1A00000A32DC2B19086F1A00000A13041204281B00000A04281600000A2C02172A162A000000133003004E00000004000011021D6F1700000A6F1800000A0A06280A0000060B03163121160C2B1208031759330807086F1900000A2A0817580C08076F1A00000A32E52B0F076F1A00000A0D1203281B00000A2A72010000702A0000133003005C00000004000011021D6F1700000A6F1800000A0A06280A0000060B0316312A160C2B1B08031759331107086F1900000A04281600000A2C02172A0817580C08076F1A00000A32DC2B18076F1A00000A0D1203281B00000A04281600000A2C02172A162A133002002A00000002000011150A160B170C2B0E0207280D0000060A060B0817580C080331EE06153302142A0602280C0000060D092A0000133005004701000006000011731C00000A0A720300007002281D00000A1000150B150C160D161304151305151306161307380E0100000715331A0211076F1E00000A1F27330E11070B151305151306388E00000007152E4B0211076F1E00000A1F27333F092C07160D38D00000001107026F1F00000A17592E0E02110717586F1E00000A1F27330C1107026F1F00000A1759330B11070C1513051513062B43170D2B3F0715331E0815331A110515331511071631101107130511042C251105175813052B1D07153319081533151105152E100211076F1E00000A1F2C33041107130607152E2508152E210207175808071758596F2000000A13080611086F2100000A150B150C1713042B331105152E2E1106152E2902110511061105596F2000000A13091109280B00000613090611096F2100000A1513051513061613041107175813071107026F1F00000A3FE5FEFFFF062A00133005002A00000007000011021F3D6F2200000A0A020B0616311402061758026F1F00000A061758596F2000000A0B076F1800000A2A0000133004004C02000008000011020A03026F1700000A0B160C2B3407086F1E00000A1F202E2507086F1E00000A1F0D2E1A07086F1E00000A1F0A2E0F07086F1E00000A1F092E04080A2B0D0817580C08076F1F00000A32C307720F000070066F2300000A0D077213000070066F2300000A1304077217000070066F2300000A130507721B000070066F2300000A130607721F000070066F2300000A13071613080916323F0911042F051104162F0511041533300911052F051105162F0511051533210911062F051106162F0511061533120911072F051107162F05110715330317130811082C5415130A09130B2B3C077223000070110B6F2300000A130C077227000070110B6F2300000A130D110C153307110D153302142A110C110D2E06110C130A2B0B110D1858130B110A152EBF110A1758130938F70000001104152E391105152E0B1105152E2F1104110530291106152E0B1106152E1F1104110630191107152E0B1107152E0F1104110730091104130938B90000001105152E361104152E0B1104152E2C1105110430261106152E0B1106152E1C1105110630161107152E0B1107152E0C110511073006110513092B7E1106152E361105152E0B1105152E2C1106110530261104152E0B1104152E1C1106110430161107152E0B1107152E0C110611073006110613092B431107152E361105152E0B1105152E2C1107110530261106152E0B1106152E1C1107110630161104152E0B1104152E0C110711043006110713092B08076F1F00000A13090706110906596F2000000A130E11090258130F11082C06110F1758130F110E110F73100000062A13300300A300000009000011722D0000700A020603280E0000060B0715330F72390000700A020603280E0000060B0715330F724B0000700A020603280E0000060B0715330F72570000700A020603280E0000060B0715330F72630000700A020603280E0000060B0715330F726F0000700A020603280E0000060B0715330F72810000700A020603280E0000060B0715330F72930000700A020603280E0000060B07152E0907066F1F00000A582A152A00133003004A0100000A000011026F2400000A72A500007003281D00000A046F2300000A0A06153318026F2400000A72AD00007003281D00000A046F2300000A0A06153318026F2400000A72B700007003281D00000A046F2300000A0A06153318026F2400000A72C100007003281D00000A046F2300000A0A06153318026F2400000A72CB00007003281D00000A046F2300000A0A06153318026F2400000A72D500007003281D00000A046F2300000A0A06153318026F2400000A72DF00007003281D00000A046F2300000A0A06153318026F2400000A72E900007003281D00000A046F2300000A0A06152E6806036F1F00000A580B02076F1700000A0C160D2B4A08096F1E00000A1F28330F020307280E0000060A06152E2E2B3908096F1E00000A1F202E2108096F1E00000A1F0D2E1608096F1E00000A1F0A2E0B08096F1E00000A1F09330D0917580D09086F1F00000A32AD062A1E02282500000A2A5602282500000A02037D0100000402047D020000042A42534A4201000100000000000C00000076322E302E35303732370000000005006C00000088040000237E0000F40400003C05000023537472696E677300000000300A0000F400000023555300240B0000100000002347554944000000340B0000F001000023426C6F620000000000000002000001571502080902000000FA25330016000001000000180000000300000002000000100000002200000025000000130000000A0000000100000001000000030000000100000000000A0001000000000006005000490006002F01140106005702450206006E02450206008B0245020600AA0245020600C30245020600DC0245020600F702450206001203450206002B0345020600440345020600740361033700880300000600B70397030600D70397030A002E0413040E00620443040E00680443040E006E0443040E00800443040E00A40443040600B60449000600F004490000000000010000000000010001000100100020000000050001000100030010003500000005000100100026009801660026009D016900502000000000960057000A0001008C20000000009600600010000300C0200000000096006B0016000500002100000000960082001C00070048210000000096009B0023000A00B421000000009600B7002A000D003022000000009600D500160011008C22000000009600E50032001300F422000000009100F700390016002C230000000091003601400018008024000000009100440149001900B82400000000910061014E001A001027000000009100690155001C00C0270000000091007C015B001E0016290000000086189201620021001E2900000000861892016C00210000000100B90100000200BF0100000100B90100000200BF0100000100B90100000200CC0100000100B90100000200D70100000300CC0100000100B90100000200DC0100000300CC0100000100B90100000200DC0100000300E50100000400CC0100000100B90100000200DC0100000100B90100000200DC0100000300E50100000100B90100000200CC0100000100EB0100000100F60100000100FF0100000200B90100000100B901000002000F0200000100B901000002001D02000003000F0200000100D701000002002902190092017200210092017200290092017200310092017200390092017200410092017200490092017200510092017200590092017200610092017200690092017700790092017D00810092016200890092016200910092017200910068049A00A1007404A00099009004A400A9009B04A900B100AC04AF00B900BD04BA00B900CB041000B900D704C700B900E104AF000C009B04D2000C00E604D800C100F604AF000C0092016200B900FF04F400B9000605FA00B9001005D800B900D704FF000C001B050501B9001F051C01B9002B052601B9003305AF000900920162002000730082002E0013004B012E001B0061012E006B00D0012E000B004B012E00330083012E00230067012E002B004B012E005300B1012E006300C7012E003B0061012E005B00BE01400073008200600073008200800073008200A00073008200C00073008200E00073008200000173008200B300BF00DC00E90069000B0121012C013F014401CC00048000000100000000000000000000000000F50300000200000000000000000000000100400000000000020000000000000000000000010007040000000002000000000000000000000001004900000000000300020000000000003C4D6F64756C653E0053514C5472616365566965776572434C522E646C6C0055736572446566696E656446756E6374696F6E73004E616D654F626A656374006D73636F726C69620053797374656D004F626A656374004765745265674578004D6174636852656745780047657453746F72656450726F6365647572654E616D65004D6174636853746F72656450726F6365647572654E616D650047657453746F72656450726F636564757265506172616D65746572004D6174636853746F72656450726F636564757265506172616D65746572004765744C6F67506172616D65746572004D617463684C6F67506172616D657465720047657453746F72656450726F6365647572654E616D654F626A6563740053797374656D2E436F6C6C656374696F6E732E47656E65726963004C697374603100476574506172616D65746572730047657456616C756546726F6D496E7465676572506172616D65746572004765744E616D650047657445786563456E64506F736974696F6E00536561726368466F7245786563506F736974696F6E002E63746F72004E616D65004C617374436861726163746572506F736974696F6E496E4E616D6500696E7075740072656745785061747465726E006F6363757272656E6365006E616D6500706F736974696F6E0076616C756500706172616D657465727300696E7456616C75650065786563456E64506F736974696F6E007374617274506F736974696F6E0065786563436F6D6D616E64006C617374436861726163746572506F736974696F6E496E4E616D650053797374656D2E5265666C656374696F6E00417373656D626C795469746C6541747472696275746500417373656D626C794465736372697074696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472696275746500417373656D626C79436F6D70616E7941747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C7954726164656D61726B41747472696275746500417373656D626C7943756C7475726541747472696275746500417373656D626C7956657273696F6E41747472696275746500417373656D626C7946696C6556657273696F6E4174747269627574650053797374656D2E446961676E6F73746963730044656275676761626C6541747472696275746500446562756767696E674D6F6465730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300436F6D70696C6174696F6E52656C61786174696F6E734174747269627574650052756E74696D65436F6D7061746962696C6974794174747269627574650053514C5472616365566965776572434C520053797374656D2E44617461004D6963726F736F66742E53716C5365727665722E5365727665720053716C46756E6374696F6E4174747269627574650053797374656D2E546578742E526567756C617245787072657373696F6E73005265676578004D617463680047726F7570006765745F537563636573730047726F7570436F6C6C656374696F6E006765745F47726F757073006765745F4974656D0043617074757265006765745F56616C756500537472696E670049734E756C6C4F72456D707479006F705F457175616C69747900537562737472696E67005472696D006765745F436F756E7400496E74333200546F537472696E6700466F726D6174006765745F4368617273006765745F4C656E67746800416464004C617374496E6465784F6600496E6465784F6600546F4C6F77657200000001000B2C007B0030007D002C0000035B000003200000030D0000030A000003090000035D0000055D005D00000B65007800650063002000001165007800650063007500740065002000000B65007800650063000D00000B65007800650063000A00000B65007800650063000900001165007800650063007500740065000D00001165007800650063007500740065000A0000116500780065006300750074006500090000077B0030007D0000090A007B0030007D00000920007B0030007D0000093B007B0030007D00000929007B0030007D0000095D007B0030007D0000090D007B0030007D00000909007B0030007D000000BF0076FE122C374B953D2D789FCBDF800008B77A5C561934E0890500020E0E0E050002020E0E0500020E0E08060003020E0E080600030E0E0808070004020E080E08060003020E080E060002120C0E08080001151209010E0E0400010E0E060002120C080E050002080E08060003080E0E080320000102060E020608052002010E08042001010E0520010111390420010108170100010054020F497344657465726D696E697374696301052001124D0E0320000204200012550520011251080320000E0607021249124D040001020E070704080808120C0420010E0805151209010E052001130008032000080C0705120C0E151209010E08080A07040E151209010E08080500020E0E1C04200103080520020E080805200101130010070A151209010E080802020808080E0E0420010803040702080E052002080E08120710080E0808080808080208080808080E080407020E0806070408080E081501001053514C2054726163652056696577657200000501000000001B0100164C61727320486F76652043687269737469616E73656E00002D010028436F7079726967687420C2A9204C61727320486F76652043687269737469616E73656E203230313500000C010007312E302E302E3000000801000200000000000801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F77730100000000005FE2B45400000000020000001C010000743600007418000052534453ACEAFFE3E9338C4C852BB7A827AB456901000000633A5C55736572735C6C6172732E63687269737469616E73656E5C446F63756D656E74735C56697375616C2053747564696F20323031335C50726F6A656374735C53514C54726163655669657765725C53514C5472616365566965776572434C525C6F626A5C52656C656173655C53514C5472616365566965776572434C522E706462000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000B83700000000000000000000CE370000002000000000000000000000000000000000000000000000C03700000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF25002000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100000001800008000000000000000000000000000000100010000003000008000000000000000000000000000000100000000004800000058400000A80300000000000000000000A80334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B00408030000010053007400720069006E006700460069006C00650049006E0066006F000000E402000001003000300030003000300034006200300000003C001100010043006F006D006D0065006E00740073000000530051004C0020005400720061006300650020005600690065007700650072000000000050001700010043006F006D00700061006E0079004E0061006D006500000000004C00610072007300200048006F00760065002000430068007200690073007400690061006E00730065006E00000000004C0011000100460069006C0065004400650073006300720069007000740069006F006E0000000000530051004C00200054007200610063006500200056006900650077006500720000000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E00300000004C001600010049006E007400650072006E0061006C004E0061006D0065000000530051004C005400720061006300650056006900650077006500720043004C0052002E0064006C006C0000007400280001004C006500670061006C0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A90020004C00610072007300200048006F00760065002000430068007200690073007400690061006E00730065006E002000320030003100350000005400160001004F0072006900670069006E0061006C00460069006C0065006E0061006D0065000000530051004C005400720061006300650056006900650077006500720043004C0052002E0064006C006C000000440011000100500072006F0064007500630074004E0061006D00650000000000530051004C00200054007200610063006500200056006900650077006500720000000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E0030000000003000000C000000E03700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
